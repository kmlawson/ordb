# Norwegian Dictionary Tests

This directory contains test suites for the Norwegian Dictionary project.

## Test Files

### `test_database_integrity.py` ⭐ **Main Test Suite**
Comprehensive test suite for database integrity and search functionality.

**Tests Include:**
- ✅ **No duplicate definitions** - Verifies the duplicate definition fix
- ✅ **Stein expressions count** - Confirms "stein" returns exactly 15 expressions
- ✅ **Cross-reference links** - Verifies >9,000 expression cross-reference links exist
- ✅ **Specific cross-references** - Tests "på huset" → "hus", "fullt hus" → "hus"/"full"
- ✅ **Database structure** - Validates all required tables and record counts
- ✅ **Search functionality** - Tests basic search operations
- ✅ **Previously problematic words** - Verifies "husmor" and "drivhuseffekt" have 2 definitions each
- ✅ **hjerte expressions** - Confirms ~25 expressions (matching web version)
- ✅ **Output formatting** - Validates proper formatting and no malformed output

### Legacy Test Files
- `test_search_features.py` - Tests for search-modular.py (different module)
- `test_improved_search.py` - Tests for improved-articles.db (different database)
- `test_examples_accuracy.py` - Tests for ordbokene.py web scraper
- `test_ordbokene.py` - Additional web scraper tests

## Running Tests

### Run Main Test Suite
```bash
cd tests
python3 test_database_integrity.py
```

### Run Individual Tests with unittest
```bash
cd tests
python3 -m unittest test_database_integrity.TestDatabaseIntegrity.test_no_duplicate_definitions -v
```

### Run All Tests
```bash
cd tests
python3 -m unittest discover -v
```

## Test Results Summary

**Latest Run Results:**
- ✅ **12 tests passed**
- ✅ **0 failures**  
- ✅ **0 errors**

**Key Metrics Verified:**
- 📊 90,841 articles in database
- 📊 111,530 definitions (no duplicates)
- 📊 9,935 expression cross-reference links
- 📊 8,218 expressions (EXPR word class)
- 📊 "stein" = 15 expressions
- 📊 "hjerte" = 25 expressions

## Requirements

Tests require:
- Python 3.6+
- `articles.db` (generated by `json-to-db.py`)
- `ordb.py` script
- Access to parent directory files

## Test Philosophy

These tests verify:
1. **Data Integrity** - No duplicate/corrupted data
2. **Functionality** - Core search features work correctly
3. **Regression Prevention** - Previously fixed issues don't reappear
4. **Performance Metrics** - Expected counts and relationships
5. **Output Quality** - Proper formatting and no malformed content

## Adding New Tests

To add new tests, extend the `TestDatabaseIntegrity` or `TestSearchFeatures` classes in `test_database_integrity.py`:

```python
def test_new_feature(self):
    """Test description."""
    print("\n🔍 Testing new feature...")
    # Test implementation
    self.assertEqual(expected, actual)
    print("✅ Test passed")
```