# Norwegian Dictionary Tests

This directory contains test suites for the Norwegian Dictionary project.

## Test Files

### `test_database_integrity.py` â­ **Main Test Suite**
Comprehensive test suite for database integrity and search functionality.

**Tests Include:**
- âœ… **No duplicate definitions** - Verifies the duplicate definition fix
- âœ… **Stein expressions count** - Confirms "stein" returns exactly 15 expressions
- âœ… **Cross-reference links** - Verifies >9,000 expression cross-reference links exist
- âœ… **Specific cross-references** - Tests "pÃ¥ huset" â†’ "hus", "fullt hus" â†’ "hus"/"full"
- âœ… **Database structure** - Validates all required tables and record counts
- âœ… **Search functionality** - Tests basic search operations
- âœ… **Previously problematic words** - Verifies "husmor" and "drivhuseffekt" have 2 definitions each
- âœ… **hjerte expressions** - Confirms ~25 expressions (matching web version)
- âœ… **Output formatting** - Validates proper formatting and no malformed output

### Legacy Test Files
- `test_search_features.py` - Tests for search-modular.py (different module)
- `test_improved_search.py` - Tests for improved-articles.db (different database)
- `test_examples_accuracy.py` - Tests for ordbokene.py web scraper
- `test_ordbokene.py` - Additional web scraper tests

## Running Tests

### Run Main Test Suite
```bash
cd tests
python3 test_database_integrity.py
```

### Run Individual Tests with unittest
```bash
cd tests
python3 -m unittest test_database_integrity.TestDatabaseIntegrity.test_no_duplicate_definitions -v
```

### Run All Tests
```bash
cd tests
python3 -m unittest discover -v
```

## Test Results Summary

**Latest Run Results:**
- âœ… **12 tests passed**
- âœ… **0 failures**  
- âœ… **0 errors**

**Key Metrics Verified:**
- ğŸ“Š 90,841 articles in database
- ğŸ“Š 111,530 definitions (no duplicates)
- ğŸ“Š 9,935 expression cross-reference links
- ğŸ“Š 8,218 expressions (EXPR word class)
- ğŸ“Š "stein" = 15 expressions
- ğŸ“Š "hjerte" = 25 expressions

## Requirements

Tests require:
- Python 3.6+
- `articles.db` (generated by `json-to-db.py`)
- `ordb.py` script
- Access to parent directory files

## Test Philosophy

These tests verify:
1. **Data Integrity** - No duplicate/corrupted data
2. **Functionality** - Core search features work correctly
3. **Regression Prevention** - Previously fixed issues don't reappear
4. **Performance Metrics** - Expected counts and relationships
5. **Output Quality** - Proper formatting and no malformed content

## Adding New Tests

To add new tests, extend the `TestDatabaseIntegrity` or `TestSearchFeatures` classes in `test_database_integrity.py`:

```python
def test_new_feature(self):
    """Test description."""
    print("\nğŸ” Testing new feature...")
    # Test implementation
    self.assertEqual(expected, actual)
    print("âœ… Test passed")
```